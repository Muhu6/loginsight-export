sudo: false
language: python
python:
  - "3.3"
  - "3.4"
  - "3.5"
  - "3.6"
  - "3.7-dev"
  - "nightly"
  - "pypy"
matrix:
  fast_finish: true
  allow_failures:
    - python: 3.3
    - python: 3.7-dev
    - python: nightly
    - python: pypy
# command to install dependencies
install:
  - pip install pep8==1.7.0
  - pip install pyflakes==1.3.0
  - pip install pytest==3.0.3
  - pip install pytest-flakes==1.0.1
  - pip install pytest-pep8==1.0.6
  - pip install pytest-catchlog==1.2.2
  - pip install requests_mock==1.1.0
  - pip install pytest-cov==2.4.0
  - pip install coveralls==1.1
  - python setup.py develop
# command to run tests
script:
  - py.test --flakes --cov=loginsightexport --cov-config=tox.ini --cov-fail-under=40 --cov-report term-missing
after_success: coveralls
before_deploy:
  - git describe
  - echo TRAVIS_TAG $TRAVIS_TAG
  - echo version=\"$TRAVIS_TAG\" > $TRAVIS_BUILD_DIR/loginsightexport/__version__.py
deploy:
  provider: pypi
  user: alanjcastonguay
  password:
    secure: Znuub7v4aE/P0k1TT7gc/x8EsqAMPQ7+6yfwP1eicDFcrMqr6FomTrZr7Rrgz/YfUT2byittlTUXC8xQP74cDq4xQYbz03rimyE5MPJZHA0h7dIYN715HXPLBmCDjqcGQH/F6yDm7sUVSZYtHtQLVInfJ327fFa5z0Ur64eV/iazVq/2Wz0svSiMUxemkv/YCgoQbNVAV65N7bjdr2/1D/73+xJaGoOHiJHKozwxKWwNMgrlapTDayWoGAz1AQZ+OK+Y5yYcmWUsePV6MI3S9s++HpVow+QBeu/4tmee22qji2V2d+8ZvCkkF0miz0a4dUzhDEu51oZEX4ZvtFDvZo2DGAaRNGhEbPR8MNfO2jLgrfvn4dUuxBiNc3KqHTKOM8IQ9JYpH1TtWaECjZykQxAlBFNQBOtsrYZ1VXrrJi8/rKge22mePsAIzX5RBLn0qMy1JTe+/eHZaDOX7t4LHMbY99cEOOebExxJtrBka3SiHNoFclJ03z9B+fAQekwJZ30eM/Aockry/LFXZge2rSfa3vDo24XuoK1vuA1MjQLiodEsNkvFZq0oOjJd6EChF5KgZEWwGqdMRD/044Se0KMHUwyka6BDMZK23ooHKJn3dffvTlnJr2faD7NYmCpsGRS1ljSYBm2fr7ysWTA629ZDYCedgbqPu1r2iOgKkdU=
  on:
    tags: true
    branch: master
