sudo: false
language: python
python:
  - "3.3"
  - "3.4"
  - "3.5"
  - "3.6"
  - "3.7-dev"
  - "nightly"
  - "pypy"
matrix:
  fast_finish: true
  allow_failures:
    - python: 3.3
    - python: 3.7-dev
    - python: nightly
    - python: pypy
# command to install dependencies
install:
  - pip install pep8==1.7.0
  - pip install pyflakes==1.3.0
  - pip install pytest==3.0.3
  - pip install pytest-flakes==1.0.1
  - pip install pytest-pep8==1.0.6
  - pip install pytest-catchlog==1.2.2
  - pip install requests_mock==1.1.0
  - pip install pytest-cov==2.4.0
  - pip install coveralls==1.1
  - python setup.py develop
# command to run tests
script:
  - py.test --flakes --cov=loginsightexport --cov-config=tox.ini --cov-fail-under=40 --cov-report term-missing
after_success: coveralls
before_deploy:
  - git describe
  - echo TRAVIS_TAG $TRAVIS_TAG
  - echo version=\"$TRAVIS_TAG\" > $TRAVIS_BUILD_DIR/loginsightexport/__version__.py
deploy:
  provider: pypi
  user: alanjcastonguay
  password:
    secure: "p0/AbqpY0NpLQkjU+gB/VoC5xWs0nDLU9m4Cf9A1xgCD6V50W8aDpja+HnOLQ2D7BDRo+y5wa6TBaqNlHoflcY/GNhL1mFzDvh7N0C1HaJ0NmfsTGeISmCqqZMxijdIP1jI4LQgtipdAyiyj+yrSuEEb0NAPqCpQlCZkKW7knMEpt2koUrGNaxNHWRwy0QjbXjvTOQUtbXcfHUQ/cLxgR288JP/bm5M5w+MZpseCYJzyLipEevr/hz+gXojr09HGtp8ocM8NeVh3fmNna8XRXPk0FPnowIx9GEW+1Ra2lWImWtvRymQHAk5YbE+oFRmwpuh8XMO6/rjE/3gcwAuSe+Fx8S6taDcH/hUM67Yk/L6odDnzcqQIMbdcMDpm6Sdsrt1LisaJwp3sUNX+/uCxv/cBibCoK43A53THBngYQw2nPp4jkzK3ta8TG6YriytbQ6ngnPL4bkdMThM0ymk6XMfR3pUXKiHjjjUDSTIyotbl4pu52ue8dWNgIZfRmASlIWhggR/nR+ZQrXKOuf3pWGbS01H0ZQuFxEDYCtMEdf3bRJTkCSrNfS8XPI7ifunTZuW+VutoEy1LEVr2N1bK5YUQ5jtkG04YuXYDZAdPSKFYu8XyJX35ojg0Ih3jyUMu52M3iQGJ6re2lOWae0pT9rP792onSR2/DgsweKBYBdo="
  on:
    tags: true
    branch: master
